#####################################################################
##                  Heated Bed
#####################################################################
[heater_bed]
heater_pin: PA1                        		# (BE0) Heater pin
sensor_pin: PB1                        		# Sensor interface (TB) sensor pin
sensor_type: ATC Semitec 104GT-2       		# ATC Semitec 104GT-2 temperature sensor type
## Heated bed temperature PID calibration command: "PID_CALIBRATE HEATER=heater_bed TARGET=100"
## Doing it while running PartFan=20% and BedFan=20% and FumeFan=20% and heater=60% max
## 12/12/24 pid_Kp=41.115 pid_Ki=1.235 pid_Kd=342.279
## Update all that HERE manually and don't use SAVE CONFIG!!!
control: pid                           	# Control method
pid_kp: 41.115                         	# PID Kp value
pid_ki: 1.235                          	# PID Ki value
pid_kd: 342.279                        	# PID Kd value
##  Adjust Max Power so your heater doesn't warp your bed. Rule of thumb is 0.4 watts / cm^2 .
min_temp: 0                            		# Minimum temperature
max_temp: 125                          		# Maximum temperature
max_power: 0.6                         		# Maximum power for 350mmx350mm at 0.4w/cm^2 = 490W  I have a 1000W!!!


#####################################################################
##                          Idle Timeout for Heated Bed
#####################################################################

[idle_timeout]
timeout: 1800                				# Turn off heated bed if idle for more than 30 minutes

#####################################################################
##                  Bed Mesh Calibration
#####################################################################
[bed_mesh]
zero_reference_position: 175,175  
#    This option is suitable for the 350 model. 
#    set this to the middle of your bed
speed: 200
#    movement speed of toolhead during bed mesh
horizontal_move_z: 5
#    height of scanner during bed mesh scan
mesh_min: 30, 30
#    start point of bed mesh [X, Y]
mesh_max: 320, 320
#    end point of bed mesh [X, Y]
probe_count: 30, 30
algorithm: bicubic


####################################################################################
##                                    Z Tilt Adjustment
####################################################################################
[z_tilt]
##  Use Z_TILT_ADJUST to level the bed.
#   A list of X, Y coordinates (one per line; subsequent lines
#   indented) describing the location of each bed "pivot point". The
#   "pivot point" is the point where the bed attaches to the given Z
#   stepper. It is described using nozzle coordinates (the X, Y position
#   of the nozzle if it could move directly above the point). The
#   first entry corresponds to stepper_z, the second to stepper_z1,
#   the third to stepper_z2, etc. This parameter must be provided.
z_positions:
   -50, 18
   175, 398
   400, 18
#   A list of X, Y coordinates (one per line; subsequent lines
#   indented) that should be probed during a Z_TILT_ADJUST command.
#   Specify coordinates of the nozzle and be sure the probe is above
#   the bed at the given nozzle coordinates. This parameter must be
#   provided.
points:
   50, 50
   175, 300
   300, 50
#   The speed (in mm/s) of non-probing moves during the calibration.
#   The default is 50.
speed: 50            		# Speed of Z tilt adjustment
#   The height (in mm) that the head should be commanded to move to
#   just prior to starting a probe operation. The default is 5.
horizontal_move_z: 10   		# Z axis move speed for adjustments
#   Number of times to retry if the probed points aren't within
#   tolerance.
retries: 10              	# Number of retries for adjustment points
#   If retries are enabled then retry if largest and smallest probed
#   points differ more than retry_tolerance. Note the smallest unit of
#   change here would be a single step. However if you are probing
#   more points than steppers then you will likely have a fixed
#   minimum value for the range of probed points which you can learn
#   by observing command output.
retry_tolerance: 0.0075  	# Retry tolerance for adjustment accuracy


######################################################################################
######  Macros
######################################################################################

# [gcode_macro Z_TILT_ADJUST]     # IDM/Cartographer optimized 3Z leveling macro
# rename_existing: _Z_TILT_ADJUST
# gcode:
    # SAVE_GCODE_STATE NAME=STATE_Z_TILT         # Save current state for Z tilt adjustment
    # BED_MESH_CLEAR                             # Clear bed mesh
    # {% if not printer.z_tilt.applied %}
      # _Z_TILT_ADJUST horizontal_move_z=10 retry_tolerance=1   # Adjust Z tilt with higher tolerance initially
    # {% endif %}
    # _Z_TILT_ADJUST horizontal_move_z=2          # Fine-tune Z tilt adjustment
    # RESTORE_GCODE_STATE NAME=STATE_Z_TILT       # Restore saved state after adjustment


####################################################################################
##                               Probe Calibration Macro
####################################################################################
[gcode_macro PROBECALIBRATE]
# Defines a G-code macro for probe calibration
gcode:
    G28                          # Home all axes
    G0 X175 Y175 Z1 F3600        # Fast move to X150 Y150 Z1 at 3600 mm/min
    PROBE_CALIBRATE              # Start probe calibration


####################################################################################
##                               Bed Leveling and Height Calibration Macro
####################################################################################
[gcode_macro G32]
# Defines a G-code macro for bed leveling and height calibration
gcode:
    BED_MESH_CLEAR				# Clear bed mesh
    G28							# Home all axes
    Z_TILT_ADJUST				# Perform gantry leveling
    G28	Z						# Home all axes
    G0 X175 Y175 Z30 F36000		# Fast move to center


[bed_mesh default]
version = 1
points =
	  0.154081, 0.138515, 0.128514, 0.127286, 0.124611, 0.114976, 0.105323, 0.100381, 0.095501, 0.088223, 0.086316, 0.085472, 0.082817, 0.083355, 0.082789, 0.082710, 0.083689, 0.085854, 0.085431, 0.097041, 0.098090, 0.082782, 0.076187, 0.076704, 0.080354, 0.082368, 0.085072, 0.084998, 0.092810, 0.098247
	  0.133490, 0.117937, 0.107106, 0.107869, 0.105265, 0.097492, 0.089134, 0.086115, 0.083736, 0.078401, 0.076131, 0.076578, 0.074993, 0.074432, 0.073981, 0.073279, 0.076415, 0.077860, 0.076497, 0.080914, 0.079868, 0.073734, 0.067697, 0.068610, 0.074403, 0.076500, 0.076991, 0.078270, 0.084321, 0.091174
	  0.115153, 0.098506, 0.090259, 0.089704, 0.089289, 0.081915, 0.074853, 0.071522, 0.070107, 0.065352, 0.064095, 0.064348, 0.063359, 0.063366, 0.062642, 0.063839, 0.066829, 0.068882, 0.065567, 0.066920, 0.067317, 0.063808, 0.061525, 0.062077, 0.067504, 0.069902, 0.071985, 0.070800, 0.075848, 0.082893
	  0.101130, 0.086481, 0.078463, 0.078585, 0.076577, 0.071908, 0.064862, 0.062894, 0.061941, 0.057754, 0.058218, 0.057739, 0.056563, 0.057985, 0.058215, 0.060155, 0.063841, 0.064475, 0.061995, 0.061480, 0.062291, 0.062998, 0.059635, 0.060198, 0.063275, 0.064351, 0.064443, 0.064313, 0.068566, 0.076840
	  0.087541, 0.072778, 0.064184, 0.065004, 0.064873, 0.059972, 0.054762, 0.052682, 0.051960, 0.047814, 0.048828, 0.048662, 0.047562, 0.049298, 0.051660, 0.054191, 0.056344, 0.058185, 0.055904, 0.056399, 0.058255, 0.059901, 0.057071, 0.054381, 0.057025, 0.058295, 0.060332, 0.060621, 0.065348, 0.073099
	  0.076249, 0.062819, 0.053624, 0.055862, 0.054496, 0.050816, 0.045956, 0.044959, 0.043136, 0.040711, 0.040648, 0.042376, 0.041509, 0.043340, 0.046139, 0.048318, 0.050896, 0.052638, 0.051177, 0.052489, 0.054141, 0.055149, 0.052769, 0.050834, 0.053905, 0.056741, 0.057701, 0.057651, 0.060949, 0.068539
	  0.062961, 0.050003, 0.042626, 0.044175, 0.044124, 0.039643, 0.034897, 0.032188, 0.032766, 0.030587, 0.030765, 0.031886, 0.032234, 0.033973, 0.036233, 0.038439, 0.041461, 0.043682, 0.043368, 0.044404, 0.045898, 0.047175, 0.045166, 0.044991, 0.048977, 0.050045, 0.051778, 0.050844, 0.055290, 0.062374
	  0.050956, 0.040270, 0.033325, 0.035846, 0.035244, 0.031334, 0.026306, 0.025226, 0.022973, 0.019468, 0.021434, 0.024476, 0.023603, 0.024671, 0.028464, 0.030719, 0.032950, 0.035847, 0.035952, 0.037084, 0.038658, 0.039311, 0.037685, 0.036902, 0.041278, 0.043631, 0.044393, 0.045236, 0.048815, 0.058303
	  0.042713, 0.032021, 0.025363, 0.026581, 0.026737, 0.023311, 0.019686, 0.016966, 0.014918, 0.011864, 0.012528, 0.015007, 0.014918, 0.016450, 0.019827, 0.023127, 0.026422, 0.029085, 0.029146, 0.028604, 0.030210, 0.031067, 0.031046, 0.031195, 0.034584, 0.037746, 0.038255, 0.038090, 0.043406, 0.051717
	  0.039860, 0.027453, 0.021182, 0.022863, 0.022917, 0.020912, 0.017160, 0.014123, 0.010975, 0.006630, 0.007801, 0.009332, 0.009895, 0.013073, 0.017622, 0.019646, 0.022710, 0.025533, 0.024310, 0.024447, 0.025183, 0.027360, 0.026544, 0.028668, 0.031530, 0.033611, 0.033870, 0.034482, 0.038883, 0.047113
	  0.035190, 0.023166, 0.017150, 0.019101, 0.019730, 0.017829, 0.013489, 0.010821, 0.007301, 0.002813, 0.002036, 0.004343, 0.005920, 0.008692, 0.012491, 0.015445, 0.018081, 0.020673, 0.019302, 0.020547, 0.022027, 0.022169, 0.023651, 0.024614, 0.029264, 0.028477, 0.029462, 0.030909, 0.035955, 0.044640
	  0.033921, 0.021988, 0.016127, 0.020017, 0.019997, 0.016388, 0.012130, 0.009062, 0.005651, 0.000063, 0.000562, 0.003104, 0.004318, 0.007276, 0.010945, 0.013736, 0.017230, 0.018198, 0.018597, 0.020125, 0.020377, 0.022048, 0.024396, 0.024846, 0.028748, 0.028733, 0.030112, 0.032135, 0.036788, 0.044542
	  0.028808, 0.017942, 0.011690, 0.014128, 0.015093, 0.012077, 0.009190, 0.004887, 0.000938, -0.003359, -0.002585, 0.000434, 0.001961, 0.005127, 0.008239, 0.010209, 0.014649, 0.015873, 0.015798, 0.016549, 0.019130, 0.021900, 0.024279, 0.025609, 0.029862, 0.030183, 0.032042, 0.033011, 0.037531, 0.044496
	  0.025406, 0.013062, 0.005861, 0.008686, 0.008794, 0.006143, 0.001285, -0.002287, -0.005018, -0.008235, -0.007544, -0.003896, -0.001625, 0.001842, 0.004821, 0.008042, 0.011677, 0.013234, 0.011671, 0.014442, 0.017085, 0.020866, 0.021648, 0.025144, 0.029767, 0.030600, 0.031196, 0.033438, 0.037162, 0.043925
	  0.018291, 0.003178, -0.001670, 0.001088, 0.000339, -0.004234, -0.009113, -0.012708, -0.013906, -0.015547, -0.014544, -0.010613, -0.007343, -0.005425, -0.001451, 0.001954, 0.005816, 0.006086, 0.005187, 0.008722, 0.011897, 0.014608, 0.017355, 0.021177, 0.026680, 0.027210, 0.028475, 0.030401, 0.035050, 0.040087
	  0.017694, 0.000862, -0.003867, -0.001990, -0.003857, -0.008963, -0.014916, -0.017121, -0.019100, -0.019156, -0.015733, -0.009463, -0.007295, -0.006527, -0.004802, -0.001575, 0.001832, 0.003353, 0.002760, 0.006186, 0.010032, 0.013781, 0.016525, 0.020997, 0.025907, 0.026782, 0.028688, 0.030938, 0.033691, 0.040304
	  0.008715, -0.001131, -0.005699, -0.006195, -0.008356, -0.013533, -0.018623, -0.021585, -0.023171, -0.024161, -0.018911, -0.008744, -0.004454, -0.008020, -0.009078, -0.008268, -0.003879, 0.000034, -0.000406, 0.001825, 0.005859, 0.009652, 0.012471, 0.017179, 0.022335, 0.023018, 0.026626, 0.029443, 0.032763, 0.035835
	  0.008274, -0.000990, -0.008056, -0.008018, -0.010108, -0.014272, -0.018827, -0.022741, -0.025650, -0.024958, -0.019618, -0.009572, -0.004552, -0.007916, -0.012686, -0.012889, -0.007048, -0.001976, -0.003257, 0.000104, 0.003542, 0.006774, 0.009599, 0.014535, 0.020588, 0.021936, 0.024480, 0.028271, 0.032398, 0.033991
	  0.008315, 0.000582, -0.008875, -0.009240, -0.009743, -0.015755, -0.020064, -0.024531, -0.026437, -0.025872, -0.022057, -0.014910, -0.010529, -0.012682, -0.014965, -0.013233, -0.007844, -0.003618, -0.003326, -0.000828, 0.001737, 0.004814, 0.007177, 0.012378, 0.019155, 0.019820, 0.023087, 0.027581, 0.033457, 0.033783
	  0.009523, 0.003473, -0.008115, -0.009245, -0.010755, -0.015591, -0.020276, -0.023250, -0.027218, -0.026424, -0.022154, -0.016867, -0.014393, -0.014842, -0.013763, -0.011267, -0.006677, -0.002664, -0.002306, 0.000085, 0.000489, 0.003716, 0.005988, 0.010950, 0.017757, 0.019296, 0.022791, 0.028289, 0.034492, 0.037796
	  0.008434, 0.003305, -0.009813, -0.011842, -0.014029, -0.017993, -0.022437, -0.024681, -0.027198, -0.028758, -0.024359, -0.021006, -0.019153, -0.017266, -0.015369, -0.013864, -0.007576, -0.004697, -0.005338, -0.004207, -0.003751, -0.001329, 0.001872, 0.006328, 0.012848, 0.014878, 0.017751, 0.024865, 0.032573, 0.037275
	  0.009409, 0.004830, -0.010134, -0.012979, -0.013999, -0.017017, -0.021707, -0.023399, -0.025937, -0.027401, -0.025787, -0.023583, -0.021286, -0.018405, -0.015728, -0.013021, -0.007507, -0.003813, -0.005274, -0.005105, -0.003882, -0.000760, 0.001400, 0.006236, 0.013575, 0.013793, 0.016928, 0.023542, 0.033651, 0.040292
	  0.012681, 0.003650, -0.011519, -0.013592, -0.013007, -0.016088, -0.020317, -0.021148, -0.023677, -0.026750, -0.025591, -0.022852, -0.021820, -0.017047, -0.013421, -0.010105, -0.003187, -0.001311, -0.002738, -0.000970, 0.000578, 0.002370, 0.004994, 0.010895, 0.016466, 0.017294, 0.019258, 0.028104, 0.037919, 0.044920
	  0.023053, 0.007329, -0.007665, -0.008696, -0.008199, -0.011085, -0.015024, -0.016460, -0.019300, -0.022497, -0.021682, -0.020567, -0.017431, -0.012789, -0.007704, -0.002037, 0.003866, 0.006250, 0.004982, 0.005306, 0.006662, 0.009518, 0.011527, 0.016232, 0.020107, 0.021472, 0.024146, 0.031093, 0.041812, 0.050079
	  0.029288, 0.009673, -0.004443, -0.005567, -0.004605, -0.006210, -0.010185, -0.012755, -0.015566, -0.018724, -0.018666, -0.016853, -0.013916, -0.008459, -0.002019, 0.003235, 0.009409, 0.013119, 0.011229, 0.010323, 0.010575, 0.012150, 0.014287, 0.017538, 0.022219, 0.022162, 0.023755, 0.031374, 0.042052, 0.049160
	  0.034520, 0.016344, 0.002470, 0.002003, 0.004102, 0.002468, -0.000679, -0.001630, -0.004204, -0.008491, -0.009158, -0.007186, -0.004222, 0.000618, 0.008471, 0.013685, 0.018326, 0.020990, 0.018952, 0.017610, 0.016439, 0.018096, 0.018612, 0.021467, 0.026018, 0.024606, 0.026504, 0.033649, 0.043138, 0.049695
	  0.040989, 0.023426, 0.010730, 0.010593, 0.012624, 0.010471, 0.008444, 0.009828, 0.007719, 0.002220, 0.001497, 0.003871, 0.006004, 0.010458, 0.016901, 0.022482, 0.026374, 0.027610, 0.024551, 0.023440, 0.021441, 0.022861, 0.022914, 0.025770, 0.028328, 0.027841, 0.027552, 0.034131, 0.043074, 0.048597
	  0.054196, 0.036317, 0.022173, 0.022984, 0.024610, 0.023046, 0.021100, 0.022848, 0.021239, 0.015733, 0.014907, 0.017676, 0.020253, 0.024232, 0.028896, 0.033068, 0.037739, 0.039009, 0.035866, 0.033220, 0.032190, 0.032375, 0.033207, 0.032898, 0.034894, 0.033152, 0.033610, 0.039576, 0.047877, 0.053834
	  0.069154, 0.049538, 0.034101, 0.033598, 0.035192, 0.034897, 0.033264, 0.033966, 0.032399, 0.026413, 0.025919, 0.029939, 0.032117, 0.035207, 0.039697, 0.043255, 0.047065, 0.049020, 0.044302, 0.042012, 0.040376, 0.041479, 0.040200, 0.039590, 0.039760, 0.037849, 0.038269, 0.044078, 0.052012, 0.057973
	  0.092874, 0.067424, 0.048158, 0.047359, 0.048967, 0.048404, 0.046286, 0.047192, 0.045016, 0.039761, 0.039884, 0.043235, 0.046178, 0.049110, 0.053155, 0.056352, 0.060047, 0.059708, 0.053870, 0.051188, 0.050336, 0.049519, 0.047828, 0.047118, 0.048008, 0.045242, 0.045325, 0.049244, 0.056162, 0.063266
x_count = 30
y_count = 30
mesh_x_pps = 2
mesh_y_pps = 2
algo = bicubic
tension = 0.2
min_x = 30.0
max_x = 320.0
min_y = 30.0
max_y = 320.0
